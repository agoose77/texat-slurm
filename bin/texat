#!/usr/bin/env bash
set -e

export SINGULARITY_CLEANENV=1

BB_WORKDIR=$(mktemp -d /scratch/${USER}_${SLURM_JOBID}.XXXXXX)

SINGULARITY_BIND="$SINGULARITY_BIND,${TEXAT_DATA_PATH}:/mnt/data"
SINGULARITY_BIND="$SINGULARITY_BIND,${TEXAT_ROOT_PATH}/etc/dask:/etc/dask"
SINGULARITY_BIND="$SINGULARITY_BIND,${TEXAT_GEANT4_PATH}:/opt/geant4-data"
SINGULARITY_BIND="$SINGULARITY_BIND,${BB_WORKDIR}:/tmp"
export SINGULARITY_BIND

exec texat-runtime.sif "$@"
